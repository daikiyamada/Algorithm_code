import java.util.*;public class Main {    public static void main(String [] args) {        Scanner sc = new Scanner(System.in);        int n = sc.nextInt();        int q = sc.nextInt();        Map<Integer,Deque<Long>> Stack = new HashMap<>();        StringBuilder sb = new StringBuilder();        for(int i=0;i<n;i++){            Deque<Long> L = new ArrayDeque<>();            Stack.put(i,L);        }        for(int i=0;i<q;i++){            int cmd = sc.nextInt();            int t = sc.nextInt();            if(cmd==0) Stack.get(t).push(sc.nextLong());            else if(cmd==1 && Stack.get(t).size()!=0) sb.append(Stack.get(t).getFirst()+"\n");            else if(cmd==2 && Stack.get(t).size()!=0) Stack.get(t).pop();        }        System.out.print(sb);    }}/*--ベクトル--        int q = sc.nextInt();        ArrayList<Long> F = new ArrayList<>();        ArrayList<Long> L = new ArrayList<>();        StringBuilder opt = new StringBuilder();        for(int i=0;i<q;i++){            int cmd = sc.nextInt();            int cmd1 = sc.nextInt();            if(cmd==0){                if(cmd1==0)F.add(sc.nextLong());                else L.add(sc.nextLong());            }            else if(cmd==2){                if(cmd1==0){                    if(F.size()!=0)F.remove(F.size()-1);                    else L.remove(0);                }                else{                    if(L.size()!=0)L.remove(L.size()-1);                    else F.remove(0);                }            }            else{                if(cmd1>F.size()-1)opt.append(L.get(cmd1-F.size())+"\n");                else opt.append(F.get(F.size()-1-cmd1)+"\n");            }        }        System.out.print(opt); *//*        Scanner sc = new Scanner(System.in);        int N = sc.nextInt();        long W = sc.nextLong();        long opt = 0;        ArrayList<set> L = new ArrayList<>();        for(int i=0;i<N;i++){            long value = sc.nextLong();            long weight = sc.nextLong();            set s = new set();            s.element(value,weight);            L.add(s);        }        Collections.sort(L, new Comparator<set>() {            @Override            public int compare(set o1, set o2) {                return o1.cost<= o2.cost?1:-1;            }        });        double opt2 = 0;        while(W>0&&L.size()>0){            set s = L.remove(0);            if(W-s.weight>0){                opt+=s.value;                W-=s.weight;            }            else{                double num = (double)W/s.weight*s.value;                PrintWriter pw = new PrintWriter();                pw.println(num+":"+s.value);                W-=s.weight;            }        }        System.out.println(opt);    }    public static class set{        long value,weight;        double cost;        public void element(long value,long weight){            this.value = value;            this.weight = weight;            this.cost = (double)value/weight;        }    } */