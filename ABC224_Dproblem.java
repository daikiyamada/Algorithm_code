import java.util.*;public class Main {    public static void main(String[] args) {        Scanner sc = new Scanner(System.in);        int M = sc.nextInt();        Map<Integer,ArrayList<Integer>> L =new HashMap<>();        for(int i=0;i<M;i++){            int s = sc.nextInt();            int t = sc.nextInt();            if(L.get(s)==null){                ArrayList<Integer> list = new ArrayList<>();                list.add(t);                L.put(s,list);            }            else L.get(s).add(t);            if(L.get(t)==null){                ArrayList<Integer> list = new ArrayList<>();                list.add(s);                L.put(t,list);            }            else L.get(t).add(s);        }        StringBuilder sb = new StringBuilder();        Map<String,Integer> S = new HashMap<>();        sb.append("0999999999");        for(int i=1;i<=8;i++){            int pj = sc.nextInt();            sb.replace(pj,pj+1,String.valueOf(i));        }        S.put(sb.toString(),0);        /**BFSにて検索開始*/        Deque<String> queue = new ArrayDeque<>();        queue.add(sb.toString());        boolean check = false;        while(queue.size()>0){            String now = queue.poll();            int depth = S.get(now);            if(now.equals("0123456789")){                System.out.println(depth);                check = true;                break;            }            /**空白発見*/            int c = now.indexOf("9");            /**空白からBFS*/            if(L.get(c)==null) continue;            for(int i:L.get(c)){                StringBuilder s = new StringBuilder(now);                char n = s.charAt(i);                s.replace(c,c+1,Character.toString(n));                s.replace(i,i+1,"9");                if(S.get(s.toString())==null){                    S.put(s.toString(),S.get(now)+1);                    queue.add(s.toString());                }            }        }        if(!check) System.out.println(-1);    }}